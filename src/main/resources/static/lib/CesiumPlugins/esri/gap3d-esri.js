/*! Copyright by 杭州德慧信息技术 http://www.dehui.info */
!function (t, e) { "object" == typeof exports && "object" == typeof module ? module.exports = e(require("Cesium")) : "function" == typeof define && define.amd ? define(["Cesium"], e) : "object" == typeof exports ? exports.esri = e(require("Cesium")) : t.esri = e(t.Cesium) }("undefined" != typeof self ? self : this, function (t) { return function (t) { function e(i) { if (n[i]) return n[i].exports; var r = n[i] = { i: i, l: !1, exports: {} }; return t[i].call(r.exports, r, r.exports, e), r.l = !0, r.exports } var n = {}; return e.m = t, e.c = n, e.d = function (t, n, i) { e.o(t, n) || Object.defineProperty(t, n, { configurable: !1, enumerable: !0, get: i }) }, e.n = function (t) { var n = t && t.__esModule ? function () { return t.default } : function () { return t }; return e.d(n, "a", n), n }, e.o = function (t, e) { return Object.prototype.hasOwnProperty.call(t, e) }, e.p = "", e(e.s = 3) }([function (t, e, n) { "use strict"; var i, r, o, s = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }; !function (n, a) { "object" === s(e) && void 0 !== t ? a(e) : (r = [e], i = a, void 0 !== (o = "function" == typeof i ? i.apply(e, r) : i) && (t.exports = o)) }(0, function (t) { function e(t) { var e, n, i, r; for (n = 1, i = arguments.length; n < i; n++) { r = arguments[n]; for (e in r) t[e] = r[e] } return t } function n(t, e) { var n = Array.prototype.slice; if (t.bind) return t.bind.apply(t, n.call(arguments, 1)); var i = n.call(arguments, 2); return function () { return t.apply(e, i.length ? i.concat(n.call(arguments)) : arguments) } } function i(t) { return t._leaflet_id = t._leaflet_id || ++Kt, t._leaflet_id } function r(t, e, n) { var i, r, o, s; return s = function () { i = !1, r && (o.apply(n, r), r = !1) }, o = function () { i ? r = arguments : (t.apply(n, arguments), setTimeout(s, e), i = !0) } } function o(t, e, n) { var i = e[1], r = e[0], o = i - r; return t === i && n ? t : ((t - r) % o + o) % o + r } function a() { return !1 } function u(t, e) { var n = Math.pow(10, void 0 === e ? 6 : e); return Math.round(t * n) / n } function l(t) { return t.trim ? t.trim() : t.replace(/^\s+|\s+$/g, "") } function h(t) { return l(t).split(/\s+/) } function c(t, e) { t.hasOwnProperty("options") || (t.options = t.options ? $t(t.options) : {}); for (var n in e) t.options[n] = e[n]; return t.options } function f(t, e, n) { var i = []; for (var r in t) i.push(encodeURIComponent(n ? r.toUpperCase() : r) + "=" + encodeURIComponent(t[r])); return (e && -1 !== e.indexOf("?") ? "&" : "?") + i.join("&") } function d(t, e) { return t.replace(te, function (t, n) { var i = e[n]; if (void 0 === i) throw new Error("No value provided for variable " + t); return "function" == typeof i && (i = i(e)), i }) } function p(t, e) { for (var n = 0; n < t.length; n++)if (t[n] === e) return n; return -1 } function g(t) { return window["webkit" + t] || window["moz" + t] || window["ms" + t] } function m(t) { var e = +new Date, n = Math.max(0, 16 - (e - ne)); return ne = e + n, window.setTimeout(t, n) } function _(t, e, i) { if (!i || ie !== m) return ie.call(window, n(t, e)); t.call(e) } function y(t) { t && re.call(window, t) } function v() { } function b(t) { if ("undefined" != typeof L && L && L.Mixin) { t = ee(t) ? t : [t]; for (var e = 0; e < t.length; e++)t[e] === L.Mixin.Events && console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.", (new Error).stack) } } function w(t, e, n) { this.x = n ? Math.round(t) : t, this.y = n ? Math.round(e) : e } function x(t, e, n) { return t instanceof w ? t : ee(t) ? new w(t[0], t[1]) : void 0 === t || null === t ? t : "object" === (void 0 === t ? "undefined" : s(t)) && "x" in t && "y" in t ? new w(t.x, t.y) : new w(t, e, n) } function P(t, e) { if (t) for (var n = e ? [t, e] : t, i = 0, r = n.length; i < r; i++)this.extend(n[i]) } function S(t, e) { return !t || t instanceof P ? t : new P(t, e) } function M(t, e) { if (t) for (var n = e ? [t, e] : t, i = 0, r = n.length; i < r; i++)this.extend(n[i]) } function E(t, e) { return t instanceof M ? t : new M(t, e) } function O(t, e, n) { if (isNaN(t) || isNaN(e)) throw new Error("Invalid LatLng object: (" + t + ", " + e + ")"); this.lat = +t, this.lng = +e, void 0 !== n && (this.alt = +n) } function T(t, e, n) { return t instanceof O ? t : ee(t) && "object" !== s(t[0]) ? 3 === t.length ? new O(t[0], t[1], t[2]) : 2 === t.length ? new O(t[0], t[1]) : null : void 0 === t || null === t ? t : "object" === (void 0 === t ? "undefined" : s(t)) && "lat" in t ? new O(t.lat, "lng" in t ? t.lng : t.lon, t.alt) : void 0 === e ? null : new O(t, e, n) } function I(t, e, n, i) { if (ee(t)) return this._a = t[0], this._b = t[1], this._c = t[2], void (this._d = t[3]); this._a = t, this._b = e, this._c = n, this._d = i } function k(t, e, n, i) { return new I(t, e, n, i) } function C(t) { return navigator.userAgent.toLowerCase().indexOf(t) >= 0 } function A(t, e, n, i) { return "touchstart" === e ? R(t, n, i) : "touchmove" === e ? q(t, n, i) : "touchend" === e && G(t, n, i), this } function j(t, e, n) { var i = t["_leaflet_" + e + n]; return "touchstart" === e ? t.removeEventListener(Xe, i, !1) : "touchmove" === e ? t.removeEventListener(Qe, i, !1) : "touchend" === e && (t.removeEventListener($e, i, !1), t.removeEventListener(Ke, i, !1)), this } function R(t, e, i) { var r = n(function (t) { if ("mouse" !== t.pointerType && t.MSPOINTER_TYPE_MOUSE && t.pointerType !== t.MSPOINTER_TYPE_MOUSE) { if (!(tn.indexOf(t.target.tagName) < 0)) return; wt(t) } F(t, e) }); t["_leaflet_touchstart" + i] = r, t.addEventListener(Xe, r, !1), nn || (document.documentElement.addEventListener(Xe, N, !0), document.documentElement.addEventListener(Qe, D, !0), document.documentElement.addEventListener($e, B, !0), document.documentElement.addEventListener(Ke, B, !0), nn = !0) } function N(t) { en[t.pointerId] = t, rn++ } function D(t) { en[t.pointerId] && (en[t.pointerId] = t) } function B(t) { delete en[t.pointerId], rn-- } function F(t, e) { t.touches = []; for (var n in en) t.touches.push(en[n]); t.changedTouches = [t], e(t) } function q(t, e, n) { var i = function (t) { (t.pointerType !== t.MSPOINTER_TYPE_MOUSE && "mouse" !== t.pointerType || 0 !== t.buttons) && F(t, e) }; t["_leaflet_touchmove" + n] = i, t.addEventListener(Qe, i, !1) } function G(t, e, n) { var i = function (t) { F(t, e) }; t["_leaflet_touchend" + n] = i, t.addEventListener($e, i, !1), t.addEventListener(Ke, i, !1) } function z(t, e, n) { function i(t) { var e; if (Ge) { if (!be || "mouse" === t.pointerType) return; e = rn } else e = t.touches.length; if (!(e > 1)) { var n = Date.now(), i = n - (o || n); s = t.touches ? t.touches[0] : t, a = i > 0 && i <= u, o = n } } function r(t) { if (a && !s.cancelBubble) { if (Ge) { if (!be || "mouse" === t.pointerType) return; var n, i, r = {}; for (i in s) n = s[i], r[i] = n && n.bind ? n.bind(s) : n; s = r } s.type = "dblclick", e(s), o = null } } var o, s, a = !1, u = 250; return t[an + on + n] = i, t[an + sn + n] = r, t[an + "dblclick" + n] = e, t.addEventListener(on, i, !1), t.addEventListener(sn, r, !1), t.addEventListener("dblclick", e, !1), this } function U(t, e) { var n = t[an + on + e], i = t[an + sn + e], r = t[an + "dblclick" + e]; return t.removeEventListener(on, n, !1), t.removeEventListener(sn, i, !1), be || t.removeEventListener("dblclick", r, !1), this } function W(t) { return "string" == typeof t ? document.getElementById(t) : t } function H(t, e) { var n = t.style[e] || t.currentStyle && t.currentStyle[e]; if ((!n || "auto" === n) && document.defaultView) { var i = document.defaultView.getComputedStyle(t, null); n = i ? i[e] : null } return "auto" === n ? null : n } function J(t, e, n) { var i = document.createElement(t); return i.className = e || "", n && n.appendChild(i), i } function Z(t) { var e = t.parentNode; e && e.removeChild(t) } function V(t) { for (; t.firstChild;)t.removeChild(t.firstChild) } function Y(t) { var e = t.parentNode; e.lastChild !== t && e.appendChild(t) } function X(t) { var e = t.parentNode; e.firstChild !== t && e.insertBefore(t, e.firstChild) } function Q(t, e) { if (void 0 !== t.classList) return t.classList.contains(e); var n = et(t); return n.length > 0 && new RegExp("(^|\\s)" + e + "(\\s|$)").test(n) } function $(t, e) { if (void 0 !== t.classList) for (var n = h(e), i = 0, r = n.length; i < r; i++)t.classList.add(n[i]); else if (!Q(t, e)) { var o = et(t); tt(t, (o ? o + " " : "") + e) } } function K(t, e) { void 0 !== t.classList ? t.classList.remove(e) : tt(t, l((" " + et(t) + " ").replace(" " + e + " ", " "))) } function tt(t, e) { void 0 === t.className.baseVal ? t.className = e : t.className.baseVal = e } function et(t) { return void 0 === t.className.baseVal ? t.className : t.className.baseVal } function nt(t, e) { "opacity" in t.style ? t.style.opacity = e : "filter" in t.style && it(t, e) } function it(t, e) { var n = !1, i = "DXImageTransform.Microsoft.Alpha"; try { n = t.filters.item(i) } catch (t) { if (1 === e) return } e = Math.round(100 * e), n ? (n.Enabled = 100 !== e, n.Opacity = e) : t.style.filter += " progid:" + i + "(opacity=" + e + ")" } function rt(t) { for (var e = document.documentElement.style, n = 0; n < t.length; n++)if (t[n] in e) return t[n]; return !1 } function ot(t, e, n) { var i = e || new w(0, 0); t.style[un] = (Ae ? "translate(" + i.x + "px," + i.y + "px)" : "translate3d(" + i.x + "px," + i.y + "px,0)") + (n ? " scale(" + n + ")" : "") } function st(t, e) { t._leaflet_pos = e, Ne ? ot(t, e) : (t.style.left = e.x + "px", t.style.top = e.y + "px") } function at(t) { return t._leaflet_pos || new w(0, 0) } function ut() { pt(window, "dragstart", wt) } function lt() { gt(window, "dragstart", wt) } function ht(t) { for (; -1 === t.tabIndex;)t = t.parentNode; t.style && (ct(), fn = t, dn = t.style.outline, t.style.outline = "none", pt(window, "keydown", ct)) } function ct() { fn && (fn.style.outline = dn, fn = void 0, dn = void 0, gt(window, "keydown", ct)) } function ft(t) { do { t = t.parentNode } while (!(t.offsetWidth && t.offsetHeight || t === document.body)); return t } function dt(t) { var e = t.getBoundingClientRect(); return { x: e.width / t.offsetWidth || 1, y: e.height / t.offsetHeight || 1, boundingClientRect: e } } function pt(t, e, n, i) { if ("object" === (void 0 === e ? "undefined" : s(e))) for (var r in e) mt(t, r, e[r], n); else { e = h(e); for (var o = 0, a = e.length; o < a; o++)mt(t, e[o], n, i) } return this } function gt(t, e, n, i) { if ("object" === (void 0 === e ? "undefined" : s(e))) for (var r in e) _t(t, r, e[r], n); else if (e) { e = h(e); for (var o = 0, a = e.length; o < a; o++)_t(t, e[o], n, i) } else { for (var u in t[mn]) _t(t, u, t[mn][u]); delete t[mn] } return this } function mt(t, e, n, r) { var o = e + i(n) + (r ? "_" + i(r) : ""); if (t[mn] && t[mn][o]) return this; var s = function (e) { return n.call(r || t, e || window.event) }, a = s; Ge && 0 === e.indexOf("touch") ? A(t, e, s, o) : !ze || "dblclick" !== e || !z || Ge && Ee ? "addEventListener" in t ? "mousewheel" === e ? t.addEventListener("onwheel" in t ? "wheel" : "mousewheel", s, !1) : "mouseenter" === e || "mouseleave" === e ? (s = function (e) { e = e || window.event, Et(t, e) && a(e) }, t.addEventListener("mouseenter" === e ? "mouseover" : "mouseout", s, !1)) : ("click" === e && xe && (s = function (t) { Ot(t, a) }), t.addEventListener(e, s, !1)) : "attachEvent" in t && t.attachEvent("on" + e, s) : z(t, s, o), t[mn] = t[mn] || {}, t[mn][o] = s } function _t(t, e, n, r) { var o = e + i(n) + (r ? "_" + i(r) : ""), s = t[mn] && t[mn][o]; if (!s) return this; Ge && 0 === e.indexOf("touch") ? j(t, e, o) : !ze || "dblclick" !== e || !U || Ge && Ee ? "removeEventListener" in t ? "mousewheel" === e ? t.removeEventListener("onwheel" in t ? "wheel" : "mousewheel", s, !1) : t.removeEventListener("mouseenter" === e ? "mouseover" : "mouseleave" === e ? "mouseout" : e, s, !1) : "detachEvent" in t && t.detachEvent("on" + e, s) : U(t, o), t[mn][o] = null } function yt(t) { return t.stopPropagation ? t.stopPropagation() : t.originalEvent ? t.originalEvent._stopped = !0 : t.cancelBubble = !0, Mt(t), this } function vt(t) { return mt(t, "mousewheel", yt), this } function bt(t) { return pt(t, "mousedown touchstart dblclick", yt), mt(t, "click", St), this } function wt(t) { return t.preventDefault ? t.preventDefault() : t.returnValue = !1, this } function xt(t) { return wt(t), yt(t), this } function Lt(t, e) { if (!e) return new w(t.clientX, t.clientY); var n = dt(e), i = n.boundingClientRect; return new w((t.clientX - i.left) / n.x - e.clientLeft, (t.clientY - i.top) / n.y - e.clientTop) } function Pt(t) { return be ? t.wheelDeltaY / 2 : t.deltaY && 0 === t.deltaMode ? -t.deltaY / _n : t.deltaY && 1 === t.deltaMode ? 20 * -t.deltaY : t.deltaY && 2 === t.deltaMode ? 60 * -t.deltaY : t.deltaX || t.deltaZ ? 0 : t.wheelDelta ? (t.wheelDeltaY || t.wheelDelta) / 2 : t.detail && Math.abs(t.detail) < 32765 ? 20 * -t.detail : t.detail ? t.detail / -32765 * 60 : 0 } function St(t) { yn[t.type] = !0 } function Mt(t) { var e = yn[t.type]; return yn[t.type] = !1, e } function Et(t, e) { var n = e.relatedTarget; if (!n) return !0; try { for (; n && n !== t;)n = n.parentNode } catch (t) { return !1 } return n !== t } function Ot(t, e) { var n = t.timeStamp || t.originalEvent && t.originalEvent.timeStamp, i = pn && n - pn; if (i && i > 100 && i < 500 || t.target._simulatedClick && !t._simulated) return void xt(t); pn = n, e(t) } function Tt(t, e) { if (!e || !t.length) return t.slice(); var n = e * e; return t = jt(t, n), t = Ct(t, n) } function It(t, e, n) { return Math.sqrt(Ft(t, e, n, !0)) } function kt(t, e, n) { return Ft(t, e, n) } function Ct(t, e) { var n = t.length, i = ("undefined" == typeof Uint8Array ? "undefined" : s(Uint8Array)) !== void 0 + "" ? Uint8Array : Array, r = new i(n); r[0] = r[n - 1] = 1, At(t, r, e, 0, n - 1); var o, a = []; for (o = 0; o < n; o++)r[o] && a.push(t[o]); return a } function At(t, e, n, i, r) { var o, s, a, u = 0; for (s = i + 1; s <= r - 1; s++)(a = Ft(t[s], t[i], t[r], !0)) > u && (o = s, u = a); u > n && (e[o] = 1, At(t, e, n, i, o), At(t, e, n, o, r)) } function jt(t, e) { for (var n = [t[0]], i = 1, r = 0, o = t.length; i < o; i++)Bt(t[i], t[r]) > e && (n.push(t[i]), r = i); return r < o - 1 && n.push(t[o - 1]), n } function Rt(t, e, n, i, r) { var o, s, a, u = i ? xn : Dt(t, n), l = Dt(e, n); for (xn = l; ;) { if (!(u | l)) return [t, e]; if (u & l) return !1; o = u || l, s = Nt(t, e, o, n, r), a = Dt(s, n), o === u ? (t = s, u = a) : (e = s, l = a) } } function Nt(t, e, n, i, r) { var o, s, a = e.x - t.x, u = e.y - t.y, l = i.min, h = i.max; return 8 & n ? (o = t.x + a * (h.y - t.y) / u, s = h.y) : 4 & n ? (o = t.x + a * (l.y - t.y) / u, s = l.y) : 2 & n ? (o = h.x, s = t.y + u * (h.x - t.x) / a) : 1 & n && (o = l.x, s = t.y + u * (l.x - t.x) / a), new w(o, s, r) } function Dt(t, e) { var n = 0; return t.x < e.min.x ? n |= 1 : t.x > e.max.x && (n |= 2), t.y < e.min.y ? n |= 4 : t.y > e.max.y && (n |= 8), n } function Bt(t, e) { var n = e.x - t.x, i = e.y - t.y; return n * n + i * i } function Ft(t, e, n, i) { var r, o = e.x, s = e.y, a = n.x - o, u = n.y - s, l = a * a + u * u; return l > 0 && (r = ((t.x - o) * a + (t.y - s) * u) / l, r > 1 ? (o = n.x, s = n.y) : r > 0 && (o += a * r, s += u * r)), a = t.x - o, u = t.y - s, i ? a * a + u * u : new w(o, s) } function qt(t) { return !ee(t[0]) || "object" !== s(t[0][0]) && void 0 !== t[0][0] } function Gt(t) { return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."), qt(t) } function zt(t, e, n) { var i, r, o, s, a, u, l, h, c, f = [1, 4, 2, 8]; for (r = 0, l = t.length; r < l; r++)t[r]._code = Dt(t[r], e); for (s = 0; s < 4; s++) { for (h = f[s], i = [], r = 0, l = t.length, o = l - 1; r < l; o = r++)a = t[r], u = t[o], a._code & h ? u._code & h || (c = Nt(u, a, h, e, n), c._code = Dt(c, e), i.push(c)) : (u._code & h && (c = Nt(u, a, h, e, n), c._code = Dt(c, e), i.push(c)), i.push(a)); t = i } return t } function Ut(t, e) { var n, i, r, o, s = "Feature" === t.type ? t.geometry : t, a = s ? s.coordinates : null, u = [], l = e && e.pointToLayer, h = e && e.coordsToLatLng || Wt; if (!a && !s) return null; switch (s.type) { case "Point": return n = h(a), l ? l(t, n) : new zn(n); case "MultiPoint": for (r = 0, o = a.length; r < o; r++)n = h(a[r]), u.push(l ? l(t, n) : new zn(n)); return new Bn(u); case "LineString": case "MultiLineString": return i = Ht(a, "LineString" === s.type ? 0 : 1, h), new Jn(i, e); case "Polygon": case "MultiPolygon": return i = Ht(a, "Polygon" === s.type ? 1 : 2, h), new Zn(i, e); case "GeometryCollection": for (r = 0, o = s.geometries.length; r < o; r++) { var c = Ut({ geometry: s.geometries[r], type: "Feature", properties: t.properties }, e); c && u.push(c) } return new Bn(u); default: throw new Error("Invalid GeoJSON object.") } } function Wt(t) { return new O(t[1], t[0], t[2]) } function Ht(t, e, n) { for (var i, r = [], o = 0, s = t.length; o < s; o++)i = e ? Ht(t[o], e - 1, n) : (n || Wt)(t[o]), r.push(i); return r } function Jt(t, e) { return e = "number" == typeof e ? e : 6, void 0 !== t.alt ? [u(t.lng, e), u(t.lat, e), u(t.alt, e)] : [u(t.lng, e), u(t.lat, e)] } function Zt(t, e, n, i) { for (var r = [], o = 0, s = t.length; o < s; o++)r.push(e ? Zt(t[o], e - 1, n, i) : Jt(t[o], i)); return !e && n && r.push(r[0]), r } function Vt(t, n) { return t.feature ? e({}, t.feature, { geometry: n }) : Yt(n) } function Yt(t) { return "Feature" === t.type || "FeatureCollection" === t.type ? t : { type: "Feature", properties: {}, geometry: t } } function Xt(t, e) { return new Vn(t, e) } var Qt = Object.freeze; Object.freeze = function (t) { return t }; var $t = Object.create || function () { function t() { } return function (e) { return t.prototype = e, new t } }(), Kt = 0, te = /\{ *([\w_-]+) *\}/g, ee = Array.isArray || function (t) { return "[object Array]" === Object.prototype.toString.call(t) }, ne = 0, ie = window.requestAnimationFrame || g("RequestAnimationFrame") || m, re = window.cancelAnimationFrame || g("CancelAnimationFrame") || g("CancelRequestAnimationFrame") || function (t) { window.clearTimeout(t) }, oe = (Object.freeze || Object)({ freeze: Qt, extend: e, create: $t, bind: n, lastId: Kt, stamp: i, throttle: r, wrapNum: o, falseFn: a, formatNum: u, trim: l, splitWords: h, setOptions: c, getParamString: f, template: d, isArray: ee, indexOf: p, emptyImageUrl: "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=", requestFn: ie, cancelFn: re, requestAnimFrame: _, cancelAnimFrame: y }); v.extend = function (t) { var n = function () { this.initialize && this.initialize.apply(this, arguments), this.callInitHooks() }, i = n.__super__ = this.prototype, r = $t(i); r.constructor = n, n.prototype = r; for (var o in this) this.hasOwnProperty(o) && "prototype" !== o && "__super__" !== o && (n[o] = this[o]); return t.statics && (e(n, t.statics), delete t.statics), t.includes && (b(t.includes), e.apply(null, [r].concat(t.includes)), delete t.includes), r.options && (t.options = e($t(r.options), t.options)), e(r, t), r._initHooks = [], r.callInitHooks = function () { if (!this._initHooksCalled) { i.callInitHooks && i.callInitHooks.call(this), this._initHooksCalled = !0; for (var t = 0, e = r._initHooks.length; t < e; t++)r._initHooks[t].call(this) } }, n }, v.include = function (t) { return e(this.prototype, t), this }, v.mergeOptions = function (t) { return e(this.prototype.options, t), this }, v.addInitHook = function (t) { var e = Array.prototype.slice.call(arguments, 1), n = "function" == typeof t ? t : function () { this[t].apply(this, e) }; return this.prototype._initHooks = this.prototype._initHooks || [], this.prototype._initHooks.push(n), this }; var se = { on: function (t, e, n) { if ("object" === (void 0 === t ? "undefined" : s(t))) for (var i in t) this._on(i, t[i], e); else { t = h(t); for (var r = 0, o = t.length; r < o; r++)this._on(t[r], e, n) } return this }, off: function (t, e, n) { if (t) if ("object" === (void 0 === t ? "undefined" : s(t))) for (var i in t) this._off(i, t[i], e); else { t = h(t); for (var r = 0, o = t.length; r < o; r++)this._off(t[r], e, n) } else delete this._events; return this }, _on: function (t, e, n) { this._events = this._events || {}; var i = this._events[t]; i || (i = [], this._events[t] = i), n === this && (n = void 0); for (var r = { fn: e, ctx: n }, o = i, s = 0, a = o.length; s < a; s++)if (o[s].fn === e && o[s].ctx === n) return; o.push(r) }, _off: function (t, e, n) { var i, r, o; if (this._events && (i = this._events[t])) { if (!e) { for (r = 0, o = i.length; r < o; r++)i[r].fn = a; return void delete this._events[t] } if (n === this && (n = void 0), i) for (r = 0, o = i.length; r < o; r++) { var s = i[r]; if (s.ctx === n && s.fn === e) return s.fn = a, this._firingCount && (this._events[t] = i = i.slice()), void i.splice(r, 1) } } }, fire: function (t, n, i) { if (!this.listens(t, i)) return this; var r = e({}, n, { type: t, target: this, sourceTarget: n && n.sourceTarget || this }); if (this._events) { var o = this._events[t]; if (o) { this._firingCount = this._firingCount + 1 || 1; for (var s = 0, a = o.length; s < a; s++) { var u = o[s]; u.fn.call(u.ctx || this, r) } this._firingCount-- } } return i && this._propagateEvent(r), this }, listens: function (t, e) { var n = this._events && this._events[t]; if (n && n.length) return !0; if (e) for (var i in this._eventParents) if (this._eventParents[i].listens(t, e)) return !0; return !1 }, once: function (t, e, i) { if ("object" === (void 0 === t ? "undefined" : s(t))) { for (var r in t) this.once(r, t[r], e); return this } var o = n(function () { this.off(t, e, i).off(t, o, i) }, this); return this.on(t, e, i).on(t, o, i) }, addEventParent: function (t) { return this._eventParents = this._eventParents || {}, this._eventParents[i(t)] = t, this }, removeEventParent: function (t) { return this._eventParents && delete this._eventParents[i(t)], this }, _propagateEvent: function (t) { for (var n in this._eventParents) this._eventParents[n].fire(t.type, e({ layer: t.target, propagatedFrom: t.target }, t), !0) } }; se.addEventListener = se.on, se.removeEventListener = se.clearAllEventListeners = se.off, se.addOneTimeEventListener = se.once, se.fireEvent = se.fire, se.hasEventListeners = se.listens; var ae = v.extend(se), ue = Math.trunc || function (t) { return t > 0 ? Math.floor(t) : Math.ceil(t) }; w.prototype = { clone: function () { return new w(this.x, this.y) }, add: function (t) { return this.clone()._add(x(t)) }, _add: function (t) { return this.x += t.x, this.y += t.y, this }, subtract: function (t) { return this.clone()._subtract(x(t)) }, _subtract: function (t) { return this.x -= t.x, this.y -= t.y, this }, divideBy: function (t) { return this.clone()._divideBy(t) }, _divideBy: function (t) { return this.x /= t, this.y /= t, this }, multiplyBy: function (t) { return this.clone()._multiplyBy(t) }, _multiplyBy: function (t) { return this.x *= t, this.y *= t, this }, scaleBy: function (t) { return new w(this.x * t.x, this.y * t.y) }, unscaleBy: function (t) { return new w(this.x / t.x, this.y / t.y) }, round: function () { return this.clone()._round() }, _round: function () { return this.x = Math.round(this.x), this.y = Math.round(this.y), this }, floor: function () { return this.clone()._floor() }, _floor: function () { return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this }, ceil: function () { return this.clone()._ceil() }, _ceil: function () { return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this }, trunc: function () { return this.clone()._trunc() }, _trunc: function () { return this.x = ue(this.x), this.y = ue(this.y), this }, distanceTo: function (t) { t = x(t); var e = t.x - this.x, n = t.y - this.y; return Math.sqrt(e * e + n * n) }, equals: function (t) { return t = x(t), t.x === this.x && t.y === this.y }, contains: function (t) { return t = x(t), Math.abs(t.x) <= Math.abs(this.x) && Math.abs(t.y) <= Math.abs(this.y) }, toString: function () { return "Point(" + u(this.x) + ", " + u(this.y) + ")" } }, P.prototype = { extend: function (t) { return t = x(t), this.min || this.max ? (this.min.x = Math.min(t.x, this.min.x), this.max.x = Math.max(t.x, this.max.x), this.min.y = Math.min(t.y, this.min.y), this.max.y = Math.max(t.y, this.max.y)) : (this.min = t.clone(), this.max = t.clone()), this }, getCenter: function (t) { return new w((this.min.x + this.max.x) / 2, (this.min.y + this.max.y) / 2, t) }, getBottomLeft: function () { return new w(this.min.x, this.max.y) }, getTopRight: function () { return new w(this.max.x, this.min.y) }, getTopLeft: function () { return this.min }, getBottomRight: function () { return this.max }, getSize: function () { return this.max.subtract(this.min) }, contains: function (t) { var e, n; return t = "number" == typeof t[0] || t instanceof w ? x(t) : S(t), t instanceof P ? (e = t.min, n = t.max) : e = n = t, e.x >= this.min.x && n.x <= this.max.x && e.y >= this.min.y && n.y <= this.max.y }, intersects: function (t) { t = S(t); var e = this.min, n = this.max, i = t.min, r = t.max, o = r.x >= e.x && i.x <= n.x, s = r.y >= e.y && i.y <= n.y; return o && s }, overlaps: function (t) { t = S(t); var e = this.min, n = this.max, i = t.min, r = t.max, o = r.x > e.x && i.x < n.x, s = r.y > e.y && i.y < n.y; return o && s }, isValid: function () { return !(!this.min || !this.max) } }, M.prototype = { extend: function (t) { var e, n, i = this._southWest, r = this._northEast; if (t instanceof O) e = t, n = t; else { if (!(t instanceof M)) return t ? this.extend(T(t) || E(t)) : this; if (e = t._southWest, n = t._northEast, !e || !n) return this } return i || r ? (i.lat = Math.min(e.lat, i.lat), i.lng = Math.min(e.lng, i.lng), r.lat = Math.max(n.lat, r.lat), r.lng = Math.max(n.lng, r.lng)) : (this._southWest = new O(e.lat, e.lng), this._northEast = new O(n.lat, n.lng)), this }, pad: function (t) { var e = this._southWest, n = this._northEast, i = Math.abs(e.lat - n.lat) * t, r = Math.abs(e.lng - n.lng) * t; return new M(new O(e.lat - i, e.lng - r), new O(n.lat + i, n.lng + r)) }, getCenter: function () { return new O((this._southWest.lat + this._northEast.lat) / 2, (this._southWest.lng + this._northEast.lng) / 2) }, getSouthWest: function () { return this._southWest }, getNorthEast: function () { return this._northEast }, getNorthWest: function () { return new O(this.getNorth(), this.getWest()) }, getSouthEast: function () { return new O(this.getSouth(), this.getEast()) }, getWest: function () { return this._southWest.lng }, getSouth: function () { return this._southWest.lat }, getEast: function () { return this._northEast.lng }, getNorth: function () { return this._northEast.lat }, contains: function (t) { t = "number" == typeof t[0] || t instanceof O || "lat" in t ? T(t) : E(t); var e, n, i = this._southWest, r = this._northEast; return t instanceof M ? (e = t.getSouthWest(), n = t.getNorthEast()) : e = n = t, e.lat >= i.lat && n.lat <= r.lat && e.lng >= i.lng && n.lng <= r.lng }, intersects: function (t) { t = E(t); var e = this._southWest, n = this._northEast, i = t.getSouthWest(), r = t.getNorthEast(), o = r.lat >= e.lat && i.lat <= n.lat, s = r.lng >= e.lng && i.lng <= n.lng; return o && s }, overlaps: function (t) { t = E(t); var e = this._southWest, n = this._northEast, i = t.getSouthWest(), r = t.getNorthEast(), o = r.lat > e.lat && i.lat < n.lat, s = r.lng > e.lng && i.lng < n.lng; return o && s }, toBBoxString: function () { return [this.getWest(), this.getSouth(), this.getEast(), this.getNorth()].join(",") }, equals: function (t, e) { return !!t && (t = E(t), this._southWest.equals(t.getSouthWest(), e) && this._northEast.equals(t.getNorthEast(), e)) }, isValid: function () { return !(!this._southWest || !this._northEast) } }, O.prototype = { equals: function (t, e) { return !!t && (t = T(t), Math.max(Math.abs(this.lat - t.lat), Math.abs(this.lng - t.lng)) <= (void 0 === e ? 1e-9 : e)) }, toString: function (t) { return "LatLng(" + u(this.lat, t) + ", " + u(this.lng, t) + ")" }, distanceTo: function (t) { return he.distance(this, T(t)) }, wrap: function () { return he.wrapLatLng(this) }, toBounds: function (t) { var e = 180 * t / 40075017, n = e / Math.cos(Math.PI / 180 * this.lat); return E([this.lat - e, this.lng - n], [this.lat + e, this.lng + n]) }, clone: function () { return new O(this.lat, this.lng, this.alt) } }; var le = { latLngToPoint: function (t, e) { var n = this.projection.project(t), i = this.scale(e); return this.transformation._transform(n, i) }, pointToLatLng: function (t, e) { var n = this.scale(e), i = this.transformation.untransform(t, n); return this.projection.unproject(i) }, project: function (t) { return this.projection.project(t) }, unproject: function (t) { return this.projection.unproject(t) }, scale: function (t) { return 256 * Math.pow(2, t) }, zoom: function (t) { return Math.log(t / 256) / Math.LN2 }, getProjectedBounds: function (t) { if (this.infinite) return null; var e = this.projection.bounds, n = this.scale(t); return new P(this.transformation.transform(e.min, n), this.transformation.transform(e.max, n)) }, infinite: !1, wrapLatLng: function (t) { var e = this.wrapLng ? o(t.lng, this.wrapLng, !0) : t.lng; return new O(this.wrapLat ? o(t.lat, this.wrapLat, !0) : t.lat, e, t.alt) }, wrapLatLngBounds: function (t) { var e = t.getCenter(), n = this.wrapLatLng(e), i = e.lat - n.lat, r = e.lng - n.lng; if (0 === i && 0 === r) return t; var o = t.getSouthWest(), s = t.getNorthEast(); return new M(new O(o.lat - i, o.lng - r), new O(s.lat - i, s.lng - r)) } }, he = e({}, le, { wrapLng: [-180, 180], R: 6371e3, distance: function (t, e) { var n = Math.PI / 180, i = t.lat * n, r = e.lat * n, o = Math.sin((e.lat - t.lat) * n / 2), s = Math.sin((e.lng - t.lng) * n / 2), a = o * o + Math.cos(i) * Math.cos(r) * s * s, u = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)); return this.R * u } }), ce = { R: 6378137, MAX_LATITUDE: 85.0511287798, project: function (t) { var e = Math.PI / 180, n = this.MAX_LATITUDE, i = Math.max(Math.min(n, t.lat), -n), r = Math.sin(i * e); return new w(this.R * t.lng * e, this.R * Math.log((1 + r) / (1 - r)) / 2) }, unproject: function (t) { var e = 180 / Math.PI; return new O((2 * Math.atan(Math.exp(t.y / this.R)) - Math.PI / 2) * e, t.x * e / this.R) }, bounds: function () { var t = 6378137 * Math.PI; return new P([-t, -t], [t, t]) }() }; I.prototype = { transform: function (t, e) { return this._transform(t.clone(), e) }, _transform: function (t, e) { return e = e || 1, t.x = e * (this._a * t.x + this._b), t.y = e * (this._c * t.y + this._d), t }, untransform: function (t, e) { return e = e || 1, new w((t.x / e - this._b) / this._a, (t.y / e - this._d) / this._c) } }; var fe, de, pe, ge = e({}, he, { code: "EPSG:3857", projection: ce, transformation: function () { var t = .5 / (Math.PI * ce.R); return k(t, .5, -t, .5) }() }), me = e({}, ge, { code: "EPSG:900913" }), _e = document.documentElement.style, ye = "ActiveXObject" in window, ve = ye && !document.addEventListener, be = "msLaunchUri" in navigator && !("documentMode" in document), we = C("webkit"), xe = C("android"), Le = C("android 2") || C("android 3"), Pe = parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1], 10), Se = xe && C("Google") && Pe < 537 && !("AudioNode" in window), Me = !!window.opera, Ee = C("chrome"), Oe = C("gecko") && !we && !Me && !ye, Te = !Ee && C("safari"), Ie = C("phantom"), ke = "OTransition" in _e, Ce = 0 === navigator.platform.indexOf("Win"), Ae = ye && "transition" in _e, je = "WebKitCSSMatrix" in window && "m11" in new window.WebKitCSSMatrix && !Le, Re = "MozPerspective" in _e, Ne = !window.L_DISABLE_3D && (Ae || je || Re) && !ke && !Ie, De = "undefined" != typeof orientation || C("mobile"), Be = De && we, Fe = De && je, qe = !window.PointerEvent && window.MSPointerEvent, Ge = !(!window.PointerEvent && !qe), ze = !window.L_NO_TOUCH && (Ge || "ontouchstart" in window || window.DocumentTouch && document instanceof window.DocumentTouch), Ue = De && Me, We = De && Oe, He = (window.devicePixelRatio || window.screen.deviceXDPI / window.screen.logicalXDPI) > 1, Je = function () { return !!document.createElement("canvas").getContext }(), Ze = !(!document.createElementNS || !function (t) { return document.createElementNS("http://www.w3.org/2000/svg", t) }("svg").createSVGRect), Ve = !Ze && function () { try { var t = document.createElement("div"); t.innerHTML = '<v:shape adj="1"/>'; var e = t.firstChild; return e.style.behavior = "url(#default#VML)", e && "object" === s(e.adj) } catch (t) { return !1 } }(), Ye = (Object.freeze || Object)({ ie: ye, ielt9: ve, edge: be, webkit: we, android: xe, android23: Le, androidStock: Se, opera: Me, chrome: Ee, gecko: Oe, safari: Te, phantom: Ie, opera12: ke, win: Ce, ie3d: Ae, webkit3d: je, gecko3d: Re, any3d: Ne, mobile: De, mobileWebkit: Be, mobileWebkit3d: Fe, msPointer: qe, pointer: Ge, touch: ze, mobileOpera: Ue, mobileGecko: We, retina: He, canvas: Je, svg: Ze, vml: Ve }), Xe = qe ? "MSPointerDown" : "pointerdown", Qe = qe ? "MSPointerMove" : "pointermove", $e = qe ? "MSPointerUp" : "pointerup", Ke = qe ? "MSPointerCancel" : "pointercancel", tn = ["INPUT", "SELECT", "OPTION"], en = {}, nn = !1, rn = 0, on = qe ? "MSPointerDown" : Ge ? "pointerdown" : "touchstart", sn = qe ? "MSPointerUp" : Ge ? "pointerup" : "touchend", an = "_leaflet_", un = rt(["transform", "webkitTransform", "OTransform", "MozTransform", "msTransform"]), ln = rt(["webkitTransition", "transition", "OTransition", "MozTransition", "msTransition"]), hn = "webkitTransition" === ln || "OTransition" === ln ? ln + "End" : "transitionend"; if ("onselectstart" in document) fe = function () { pt(window, "selectstart", wt) }, de = function () { gt(window, "selectstart", wt) }; else { var cn = rt(["userSelect", "WebkitUserSelect", "OUserSelect", "MozUserSelect", "msUserSelect"]); fe = function () { if (cn) { var t = document.documentElement.style; pe = t[cn], t[cn] = "none" } }, de = function () { cn && (document.documentElement.style[cn] = pe, pe = void 0) } } var fn, dn, pn, gn = (Object.freeze || Object)({ TRANSFORM: un, TRANSITION: ln, TRANSITION_END: hn, get: W, getStyle: H, create: J, remove: Z, empty: V, toFront: Y, toBack: X, hasClass: Q, addClass: $, removeClass: K, setClass: tt, getClass: et, setOpacity: nt, testProp: rt, setTransform: ot, setPosition: st, getPosition: at, disableTextSelection: fe, enableTextSelection: de, disableImageDrag: ut, enableImageDrag: lt, preventOutline: ht, restoreOutline: ct, getSizedParentNode: ft, getScale: dt }), mn = "_leaflet_events", _n = Ce && Ee ? 2 * window.devicePixelRatio : Oe ? window.devicePixelRatio : 1, yn = {}, vn = (Object.freeze || Object)({ on: pt, off: gt, stopPropagation: yt, disableScrollPropagation: vt, disableClickPropagation: bt, preventDefault: wt, stop: xt, getMousePosition: Lt, getWheelDelta: Pt, fakeStop: St, skipped: Mt, isExternalTarget: Et, addListener: pt, removeListener: gt }), bn = ae.extend({ run: function (t, e, n, i) { this.stop(), this._el = t, this._inProgress = !0, this._duration = n || .25, this._easeOutPower = 1 / Math.max(i || .5, .2), this._startPos = at(t), this._offset = e.subtract(this._startPos), this._startTime = +new Date, this.fire("start"), this._animate() }, stop: function () { this._inProgress && (this._step(!0), this._complete()) }, _animate: function () { this._animId = _(this._animate, this), this._step() }, _step: function (t) { var e = +new Date - this._startTime, n = 1e3 * this._duration; e < n ? this._runFrame(this._easeOut(e / n), t) : (this._runFrame(1), this._complete()) }, _runFrame: function (t, e) { var n = this._startPos.add(this._offset.multiplyBy(t)); e && n._round(), st(this._el, n), this.fire("step") }, _complete: function () { y(this._animId), this._inProgress = !1, this.fire("end") }, _easeOut: function (t) { return 1 - Math.pow(1 - t, this._easeOutPower) } }), wn = v.extend({ initialize: function (t) { this._map = t }, enable: function () { return this._enabled ? this : (this._enabled = !0, this.addHooks(), this) }, disable: function () { return this._enabled ? (this._enabled = !1, this.removeHooks(), this) : this }, enabled: function () { return !!this._enabled } }); wn.addTo = function (t, e) { return t.addHandler(e, this), this }; var xn, Ln = { Events: se }, Pn = ze ? "touchstart mousedown" : "mousedown", Sn = { mousedown: "mouseup", touchstart: "touchend", pointerdown: "touchend", MSPointerDown: "touchend" }, Mn = { mousedown: "mousemove", touchstart: "touchmove", pointerdown: "touchmove", MSPointerDown: "touchmove" }, En = ae.extend({ options: { clickTolerance: 3 }, initialize: function (t, e, n, i) { c(this, i), this._element = t, this._dragStartTarget = e || t, this._preventOutline = n }, enable: function () { this._enabled || (pt(this._dragStartTarget, Pn, this._onDown, this), this._enabled = !0) }, disable: function () { this._enabled && (En._dragging === this && this.finishDrag(), gt(this._dragStartTarget, Pn, this._onDown, this), this._enabled = !1, this._moved = !1) }, _onDown: function (t) { if (!t._simulated && this._enabled && (this._moved = !1, !Q(this._element, "leaflet-zoom-anim") && !(En._dragging || t.shiftKey || 1 !== t.which && 1 !== t.button && !t.touches || (En._dragging = this, this._preventOutline && ht(this._element), ut(), fe(), this._moving)))) { this.fire("down"); var e = t.touches ? t.touches[0] : t, n = ft(this._element); this._startPoint = new w(e.clientX, e.clientY), this._parentScale = dt(n), pt(document, Mn[t.type], this._onMove, this), pt(document, Sn[t.type], this._onUp, this) } }, _onMove: function (t) { if (!t._simulated && this._enabled) { if (t.touches && t.touches.length > 1) return void (this._moved = !0); var e = t.touches && 1 === t.touches.length ? t.touches[0] : t, n = new w(e.clientX, e.clientY)._subtract(this._startPoint); (n.x || n.y) && (Math.abs(n.x) + Math.abs(n.y) < this.options.clickTolerance || (n.x /= this._parentScale.x, n.y /= this._parentScale.y, wt(t), this._moved || (this.fire("dragstart"), this._moved = !0, this._startPos = at(this._element).subtract(n), $(document.body, "leaflet-dragging"), this._lastTarget = t.target || t.srcElement, window.SVGElementInstance && this._lastTarget instanceof SVGElementInstance && (this._lastTarget = this._lastTarget.correspondingUseElement), $(this._lastTarget, "leaflet-drag-target")), this._newPos = this._startPos.add(n), this._moving = !0, y(this._animRequest), this._lastEvent = t, this._animRequest = _(this._updatePosition, this, !0))) } }, _updatePosition: function () { var t = { originalEvent: this._lastEvent }; this.fire("predrag", t), st(this._element, this._newPos), this.fire("drag", t) }, _onUp: function (t) { !t._simulated && this._enabled && this.finishDrag() }, finishDrag: function () { K(document.body, "leaflet-dragging"), this._lastTarget && (K(this._lastTarget, "leaflet-drag-target"), this._lastTarget = null); for (var t in Mn) gt(document, Mn[t], this._onMove, this), gt(document, Sn[t], this._onUp, this); lt(), de(), this._moved && this._moving && (y(this._animRequest), this.fire("dragend", { distance: this._newPos.distanceTo(this._startPos) })), this._moving = !1, En._dragging = !1 } }), On = (Object.freeze || Object)({ simplify: Tt, pointToSegmentDistance: It, closestPointOnSegment: kt, clipSegment: Rt, _getEdgeIntersection: Nt, _getBitCode: Dt, _sqClosestPointOnSegment: Ft, isFlat: qt, _flat: Gt }), Tn = (Object.freeze || Object)({ clipPolygon: zt }), In = { project: function (t) { return new w(t.lng, t.lat) }, unproject: function (t) { return new O(t.y, t.x) }, bounds: new P([-180, -90], [180, 90]) }, kn = { R: 6378137, R_MINOR: 6356752.314245179, bounds: new P([-20037508.34279, -15496570.73972], [20037508.34279, 18764656.23138]), project: function (t) { var e = Math.PI / 180, n = this.R, i = t.lat * e, r = this.R_MINOR / n, o = Math.sqrt(1 - r * r), s = o * Math.sin(i), a = Math.tan(Math.PI / 4 - i / 2) / Math.pow((1 - s) / (1 + s), o / 2); return i = -n * Math.log(Math.max(a, 1e-10)), new w(t.lng * e * n, i) }, unproject: function (t) { for (var e, n = 180 / Math.PI, i = this.R, r = this.R_MINOR / i, o = Math.sqrt(1 - r * r), s = Math.exp(-t.y / i), a = Math.PI / 2 - 2 * Math.atan(s), u = 0, l = .1; u < 15 && Math.abs(l) > 1e-7; u++)e = o * Math.sin(a), e = Math.pow((1 - e) / (1 + e), o / 2), l = Math.PI / 2 - 2 * Math.atan(s * e) - a, a += l; return new O(a * n, t.x * n / i) } }, Cn = (Object.freeze || Object)({ LonLat: In, Mercator: kn, SphericalMercator: ce }), An = e({}, he, { code: "EPSG:3395", projection: kn, transformation: function () { var t = .5 / (Math.PI * kn.R); return k(t, .5, -t, .5) }() }), jn = e({}, he, { code: "EPSG:4326", projection: In, transformation: k(1 / 180, 1, -1 / 180, .5) }), Rn = e({}, le, { projection: In, transformation: k(1, 0, -1, 0), scale: function (t) { return Math.pow(2, t) }, zoom: function (t) { return Math.log(t) / Math.LN2 }, distance: function (t, e) { var n = e.lng - t.lng, i = e.lat - t.lat; return Math.sqrt(n * n + i * i) }, infinite: !0 }); le.Earth = he, le.EPSG3395 = An, le.EPSG3857 = ge, le.EPSG900913 = me, le.EPSG4326 = jn, le.Simple = Rn; var Nn = ae.extend({ options: { pane: "overlayPane", attribution: null, bubblingMouseEvents: !0 }, addTo: function (t) { return t.addLayer(this), this }, remove: function () { return this.removeFrom(this._map || this._mapToAdd) }, removeFrom: function (t) { return t && t.removeLayer(this), this }, getPane: function (t) { return this._map.getPane(t ? this.options[t] || t : this.options.pane) }, addInteractiveTarget: function (t) { return this._map._targets[i(t)] = this, this }, removeInteractiveTarget: function (t) { return delete this._map._targets[i(t)], this }, getAttribution: function () { return this.options.attribution }, _layerAdd: function (t) { var e = t.target; if (e.hasLayer(this)) { if (this._map = e, this._zoomAnimated = e._zoomAnimated, this.getEvents) { var n = this.getEvents(); e.on(n, this), this.once("remove", function () { e.off(n, this) }, this) } this.onAdd(e), this.getAttribution && e.attributionControl && e.attributionControl.addAttribution(this.getAttribution()), this.fire("add"), e.fire("layeradd", { layer: this }) } } }), Dn = Nn.extend({ initialize: function (t, e) { c(this, e), this._layers = {}; var n, i; if (t) for (n = 0, i = t.length; n < i; n++)this.addLayer(t[n]) }, addLayer: function (t) { var e = this.getLayerId(t); return this._layers[e] = t, this._map && this._map.addLayer(t), this }, removeLayer: function (t) { var e = t in this._layers ? t : this.getLayerId(t); return this._map && this._layers[e] && this._map.removeLayer(this._layers[e]), delete this._layers[e], this }, hasLayer: function (t) { return !!t && (t in this._layers || this.getLayerId(t) in this._layers) }, clearLayers: function () { return this.eachLayer(this.removeLayer, this) }, invoke: function (t) { var e, n, i = Array.prototype.slice.call(arguments, 1); for (e in this._layers) n = this._layers[e], n[t] && n[t].apply(n, i); return this }, onAdd: function (t) { this.eachLayer(t.addLayer, t) }, onRemove: function (t) { this.eachLayer(t.removeLayer, t) }, eachLayer: function (t, e) { for (var n in this._layers) t.call(e, this._layers[n]); return this }, getLayer: function (t) { return this._layers[t] }, getLayers: function () { var t = []; return this.eachLayer(t.push, t), t }, setZIndex: function (t) { return this.invoke("setZIndex", t) }, getLayerId: function (t) { return i(t) } }), Bn = Dn.extend({ addLayer: function (t) { return this.hasLayer(t) ? this : (t.addEventParent(this), Dn.prototype.addLayer.call(this, t), this.fire("layeradd", { layer: t })) }, removeLayer: function (t) { return this.hasLayer(t) ? (t in this._layers && (t = this._layers[t]), t.removeEventParent(this), Dn.prototype.removeLayer.call(this, t), this.fire("layerremove", { layer: t })) : this }, setStyle: function (t) { return this.invoke("setStyle", t) }, bringToFront: function () { return this.invoke("bringToFront") }, bringToBack: function () { return this.invoke("bringToBack") }, getBounds: function () { var t = new M; for (var e in this._layers) { var n = this._layers[e]; t.extend(n.getBounds ? n.getBounds() : n.getLatLng()) } return t } }), Fn = v.extend({ options: { popupAnchor: [0, 0], tooltipAnchor: [0, 0] }, initialize: function (t) { c(this, t) }, createIcon: function (t) { return this._createIcon("icon", t) }, createShadow: function (t) { return this._createIcon("shadow", t) }, _createIcon: function (t, e) { var n = this._getIconUrl(t); if (!n) { if ("icon" === t) throw new Error("iconUrl not set in Icon options (see the docs)."); return null } var i = this._createImg(n, e && "IMG" === e.tagName ? e : null); return this._setIconStyles(i, t), i }, _setIconStyles: function (t, e) { var n = this.options, i = n[e + "Size"]; "number" == typeof i && (i = [i, i]); var r = x(i), o = x("shadow" === e && n.shadowAnchor || n.iconAnchor || r && r.divideBy(2, !0)); t.className = "leaflet-marker-" + e + " " + (n.className || ""), o && (t.style.marginLeft = -o.x + "px", t.style.marginTop = -o.y + "px"), r && (t.style.width = r.x + "px", t.style.height = r.y + "px") }, _createImg: function (t, e) { return e = e || document.createElement("img"), e.src = t, e }, _getIconUrl: function (t) { return He && this.options[t + "RetinaUrl"] || this.options[t + "Url"] } }), qn = Fn.extend({ options: { iconUrl: "marker-icon.png", iconRetinaUrl: "marker-icon-2x.png", shadowUrl: "marker-shadow.png", iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34], tooltipAnchor: [16, -28], shadowSize: [41, 41] }, _getIconUrl: function (t) { return qn.imagePath || (qn.imagePath = this._detectIconPath()), (this.options.imagePath || qn.imagePath) + Fn.prototype._getIconUrl.call(this, t) }, _detectIconPath: function () { var t = J("div", "leaflet-default-icon-path", document.body), e = H(t, "background-image") || H(t, "backgroundImage"); return document.body.removeChild(t), e = null === e || 0 !== e.indexOf("url") ? "" : e.replace(/^url\(["']?/, "").replace(/marker-icon\.png["']?\)$/, "") } }), Gn = wn.extend({ initialize: function (t) { this._marker = t }, addHooks: function () { var t = this._marker._icon; this._draggable || (this._draggable = new En(t, t, !0)), this._draggable.on({ dragstart: this._onDragStart, predrag: this._onPreDrag, drag: this._onDrag, dragend: this._onDragEnd }, this).enable(), $(t, "leaflet-marker-draggable") }, removeHooks: function () { this._draggable.off({ dragstart: this._onDragStart, predrag: this._onPreDrag, drag: this._onDrag, dragend: this._onDragEnd }, this).disable(), this._marker._icon && K(this._marker._icon, "leaflet-marker-draggable") }, moved: function () { return this._draggable && this._draggable._moved }, _adjustPan: function (t) { var e = this._marker, n = e._map, i = this._marker.options.autoPanSpeed, r = this._marker.options.autoPanPadding, o = at(e._icon), s = n.getPixelBounds(), a = n.getPixelOrigin(), u = S(s.min._subtract(a).add(r), s.max._subtract(a).subtract(r)); if (!u.contains(o)) { var l = x((Math.max(u.max.x, o.x) - u.max.x) / (s.max.x - u.max.x) - (Math.min(u.min.x, o.x) - u.min.x) / (s.min.x - u.min.x), (Math.max(u.max.y, o.y) - u.max.y) / (s.max.y - u.max.y) - (Math.min(u.min.y, o.y) - u.min.y) / (s.min.y - u.min.y)).multiplyBy(i); n.panBy(l, { animate: !1 }), this._draggable._newPos._add(l), this._draggable._startPos._add(l), st(e._icon, this._draggable._newPos), this._onDrag(t), this._panRequest = _(this._adjustPan.bind(this, t)) } }, _onDragStart: function () { this._oldLatLng = this._marker.getLatLng(), this._marker.closePopup().fire("movestart").fire("dragstart") }, _onPreDrag: function (t) { this._marker.options.autoPan && (y(this._panRequest), this._panRequest = _(this._adjustPan.bind(this, t))) }, _onDrag: function (t) { var e = this._marker, n = e._shadow, i = at(e._icon), r = e._map.layerPointToLatLng(i); n && st(n, i), e._latlng = r, t.latlng = r, t.oldLatLng = this._oldLatLng, e.fire("move", t).fire("drag", t) }, _onDragEnd: function (t) { y(this._panRequest), delete this._oldLatLng, this._marker.fire("moveend").fire("dragend", t) } }), zn = Nn.extend({ options: { icon: new qn, interactive: !0, keyboard: !0, title: "", alt: "", zIndexOffset: 0, opacity: 1, riseOnHover: !1, riseOffset: 250, pane: "markerPane", bubblingMouseEvents: !1, draggable: !1, autoPan: !1, autoPanPadding: [50, 50], autoPanSpeed: 10 }, initialize: function (t, e) { c(this, e), this._latlng = T(t) }, onAdd: function (t) { this._zoomAnimated = this._zoomAnimated && t.options.markerZoomAnimation, this._zoomAnimated && t.on("zoomanim", this._animateZoom, this), this._initIcon(), this.update() }, onRemove: function (t) { this.dragging && this.dragging.enabled() && (this.options.draggable = !0, this.dragging.removeHooks()), delete this.dragging, this._zoomAnimated && t.off("zoomanim", this._animateZoom, this), this._removeIcon(), this._removeShadow() }, getEvents: function () { return { zoom: this.update, viewreset: this.update } }, getLatLng: function () { return this._latlng }, setLatLng: function (t) { var e = this._latlng; return this._latlng = T(t), this.update(), this.fire("move", { oldLatLng: e, latlng: this._latlng }) }, setZIndexOffset: function (t) { return this.options.zIndexOffset = t, this.update() }, setIcon: function (t) { return this.options.icon = t, this._map && (this._initIcon(), this.update()), this._popup && this.bindPopup(this._popup, this._popup.options), this }, getElement: function () { return this._icon }, update: function () { if (this._icon && this._map) { var t = this._map.latLngToLayerPoint(this._latlng).round(); this._setPos(t) } return this }, _initIcon: function () { var t = this.options, e = "leaflet-zoom-" + (this._zoomAnimated ? "animated" : "hide"), n = t.icon.createIcon(this._icon), i = !1; n !== this._icon && (this._icon && this._removeIcon(), i = !0, t.title && (n.title = t.title), "IMG" === n.tagName && (n.alt = t.alt || "")), $(n, e), t.keyboard && (n.tabIndex = "0"), this._icon = n, t.riseOnHover && this.on({ mouseover: this._bringToFront, mouseout: this._resetZIndex }); var r = t.icon.createShadow(this._shadow), o = !1; r !== this._shadow && (this._removeShadow(), o = !0), r && ($(r, e), r.alt = ""), this._shadow = r, t.opacity < 1 && this._updateOpacity(), i && this.getPane().appendChild(this._icon), this._initInteraction(), r && o && this.getPane("shadowPane").appendChild(this._shadow) }, _removeIcon: function () { this.options.riseOnHover && this.off({ mouseover: this._bringToFront, mouseout: this._resetZIndex }), Z(this._icon), this.removeInteractiveTarget(this._icon), this._icon = null }, _removeShadow: function () { this._shadow && Z(this._shadow), this._shadow = null }, _setPos: function (t) { st(this._icon, t), this._shadow && st(this._shadow, t), this._zIndex = t.y + this.options.zIndexOffset, this._resetZIndex() }, _updateZIndex: function (t) { this._icon.style.zIndex = this._zIndex + t }, _animateZoom: function (t) { var e = this._map._latLngToNewLayerPoint(this._latlng, t.zoom, t.center).round(); this._setPos(e) }, _initInteraction: function () { if (this.options.interactive && ($(this._icon, "leaflet-interactive"), this.addInteractiveTarget(this._icon), Gn)) { var t = this.options.draggable; this.dragging && (t = this.dragging.enabled(), this.dragging.disable()), this.dragging = new Gn(this), t && this.dragging.enable() } }, setOpacity: function (t) { return this.options.opacity = t, this._map && this._updateOpacity(), this }, _updateOpacity: function () { var t = this.options.opacity; nt(this._icon, t), this._shadow && nt(this._shadow, t) }, _bringToFront: function () { this._updateZIndex(this.options.riseOffset) }, _resetZIndex: function () { this._updateZIndex(0) }, _getPopupAnchor: function () { return this.options.icon.options.popupAnchor }, _getTooltipAnchor: function () { return this.options.icon.options.tooltipAnchor } }), Un = Nn.extend({ options: { stroke: !0, color: "#3388ff", weight: 3, opacity: 1, lineCap: "round", lineJoin: "round", dashArray: null, dashOffset: null, fill: !1, fillColor: null, fillOpacity: .2, fillRule: "evenodd", interactive: !0, bubblingMouseEvents: !0 }, beforeAdd: function (t) { this._renderer = t.getRenderer(this) }, onAdd: function () { this._renderer._initPath(this), this._reset(), this._renderer._addPath(this) }, onRemove: function () { this._renderer._removePath(this) }, redraw: function () { return this._map && this._renderer._updatePath(this), this }, setStyle: function (t) { return c(this, t), this._renderer && this._renderer._updateStyle(this), this }, bringToFront: function () { return this._renderer && this._renderer._bringToFront(this), this }, bringToBack: function () { return this._renderer && this._renderer._bringToBack(this), this }, getElement: function () { return this._path }, _reset: function () { this._project(), this._update() }, _clickTolerance: function () { return (this.options.stroke ? this.options.weight / 2 : 0) + this._renderer.options.tolerance } }), Wn = Un.extend({ options: { fill: !0, radius: 10 }, initialize: function (t, e) { c(this, e), this._latlng = T(t), this._radius = this.options.radius }, setLatLng: function (t) { return this._latlng = T(t), this.redraw(), this.fire("move", { latlng: this._latlng }) }, getLatLng: function () { return this._latlng }, setRadius: function (t) { return this.options.radius = this._radius = t, this.redraw() }, getRadius: function () { return this._radius }, setStyle: function (t) { var e = t && t.radius || this._radius; return Un.prototype.setStyle.call(this, t), this.setRadius(e), this }, _project: function () { this._point = this._map.latLngToLayerPoint(this._latlng), this._updateBounds() }, _updateBounds: function () { var t = this._radius, e = this._radiusY || t, n = this._clickTolerance(), i = [t + n, e + n]; this._pxBounds = new P(this._point.subtract(i), this._point.add(i)) }, _update: function () { this._map && this._updatePath() }, _updatePath: function () { this._renderer._updateCircle(this) }, _empty: function () { return this._radius && !this._renderer._bounds.intersects(this._pxBounds) }, _containsPoint: function (t) { return t.distanceTo(this._point) <= this._radius + this._clickTolerance() } }), Hn = Wn.extend({ initialize: function (t, n, i) { if ("number" == typeof n && (n = e({}, i, { radius: n })), c(this, n), this._latlng = T(t), isNaN(this.options.radius)) throw new Error("Circle radius cannot be NaN"); this._mRadius = this.options.radius }, setRadius: function (t) { return this._mRadius = t, this.redraw() }, getRadius: function () { return this._mRadius }, getBounds: function () { var t = [this._radius, this._radiusY || this._radius]; return new M(this._map.layerPointToLatLng(this._point.subtract(t)), this._map.layerPointToLatLng(this._point.add(t))) }, setStyle: Un.prototype.setStyle, _project: function () { var t = this._latlng.lng, e = this._latlng.lat, n = this._map, i = n.options.crs; if (i.distance === he.distance) { var r = Math.PI / 180, o = this._mRadius / he.R / r, s = n.project([e + o, t]), a = n.project([e - o, t]), u = s.add(a).divideBy(2), l = n.unproject(u).lat, h = Math.acos((Math.cos(o * r) - Math.sin(e * r) * Math.sin(l * r)) / (Math.cos(e * r) * Math.cos(l * r))) / r; (isNaN(h) || 0 === h) && (h = o / Math.cos(Math.PI / 180 * e)), this._point = u.subtract(n.getPixelOrigin()), this._radius = isNaN(h) ? 0 : u.x - n.project([l, t - h]).x, this._radiusY = u.y - s.y } else { var c = i.unproject(i.project(this._latlng).subtract([this._mRadius, 0])); this._point = n.latLngToLayerPoint(this._latlng), this._radius = this._point.x - n.latLngToLayerPoint(c).x } this._updateBounds() } }), Jn = Un.extend({ options: { smoothFactor: 1, noClip: !1 }, initialize: function (t, e) { c(this, e), this._setLatLngs(t) }, getLatLngs: function () { return this._latlngs }, setLatLngs: function (t) { return this._setLatLngs(t), this.redraw() }, isEmpty: function () { return !this._latlngs.length }, closestLayerPoint: function (t) { for (var e, n, i = 1 / 0, r = null, o = Ft, s = 0, a = this._parts.length; s < a; s++)for (var u = this._parts[s], l = 1, h = u.length; l < h; l++) { e = u[l - 1], n = u[l]; var c = o(t, e, n, !0); c < i && (i = c, r = o(t, e, n)) } return r && (r.distance = Math.sqrt(i)), r }, getCenter: function () { if (!this._map) throw new Error("Must add layer to map before using getCenter()"); var t, e, n, i, r, o, s, a = this._rings[0], u = a.length; if (!u) return null; for (t = 0, e = 0; t < u - 1; t++)e += a[t].distanceTo(a[t + 1]) / 2; if (0 === e) return this._map.layerPointToLatLng(a[0]); for (t = 0, i = 0; t < u - 1; t++)if (r = a[t], o = a[t + 1], n = r.distanceTo(o), (i += n) > e) return s = (i - e) / n, this._map.layerPointToLatLng([o.x - s * (o.x - r.x), o.y - s * (o.y - r.y)]) }, getBounds: function () { return this._bounds }, addLatLng: function (t, e) { return e = e || this._defaultShape(), t = T(t), e.push(t), this._bounds.extend(t), this.redraw() }, _setLatLngs: function (t) { this._bounds = new M, this._latlngs = this._convertLatLngs(t) }, _defaultShape: function () { return qt(this._latlngs) ? this._latlngs : this._latlngs[0] }, _convertLatLngs: function (t) { for (var e = [], n = qt(t), i = 0, r = t.length; i < r; i++)n ? (e[i] = T(t[i]), this._bounds.extend(e[i])) : e[i] = this._convertLatLngs(t[i]); return e }, _project: function () { var t = new P; this._rings = [], this._projectLatlngs(this._latlngs, this._rings, t); var e = this._clickTolerance(), n = new w(e, e); this._bounds.isValid() && t.isValid() && (t.min._subtract(n), t.max._add(n), this._pxBounds = t) }, _projectLatlngs: function (t, e, n) { var i, r, o = t[0] instanceof O, s = t.length; if (o) { for (r = [], i = 0; i < s; i++)r[i] = this._map.latLngToLayerPoint(t[i]), n.extend(r[i]); e.push(r) } else for (i = 0; i < s; i++)this._projectLatlngs(t[i], e, n) }, _clipPoints: function () { var t = this._renderer._bounds; if (this._parts = [], this._pxBounds && this._pxBounds.intersects(t)) { if (this.options.noClip) return void (this._parts = this._rings); var e, n, i, r, o, s, a, u = this._parts; for (e = 0, i = 0, r = this._rings.length; e < r; e++)for (a = this._rings[e], n = 0, o = a.length; n < o - 1; n++)(s = Rt(a[n], a[n + 1], t, n, !0)) && (u[i] = u[i] || [], u[i].push(s[0]), s[1] === a[n + 1] && n !== o - 2 || (u[i].push(s[1]), i++)) } }, _simplifyPoints: function () { for (var t = this._parts, e = this.options.smoothFactor, n = 0, i = t.length; n < i; n++)t[n] = Tt(t[n], e) }, _update: function () { this._map && (this._clipPoints(), this._simplifyPoints(), this._updatePath()) }, _updatePath: function () { this._renderer._updatePoly(this) }, _containsPoint: function (t, e) { var n, i, r, o, s, a, u = this._clickTolerance(); if (!this._pxBounds || !this._pxBounds.contains(t)) return !1; for (n = 0, o = this._parts.length; n < o; n++)for (a = this._parts[n], i = 0, s = a.length, r = s - 1; i < s; r = i++)if ((e || 0 !== i) && It(t, a[r], a[i]) <= u) return !0; return !1 } }); Jn._flat = Gt; var Zn = Jn.extend({ options: { fill: !0 }, isEmpty: function () { return !this._latlngs.length || !this._latlngs[0].length }, getCenter: function () { if (!this._map) throw new Error("Must add layer to map before using getCenter()"); var t, e, n, i, r, o, s, a, u, l = this._rings[0], h = l.length; if (!h) return null; for (o = s = a = 0, t = 0, e = h - 1; t < h; e = t++)n = l[t], i = l[e], r = n.y * i.x - i.y * n.x, s += (n.x + i.x) * r, a += (n.y + i.y) * r, o += 3 * r; return u = 0 === o ? l[0] : [s / o, a / o], this._map.layerPointToLatLng(u) }, _convertLatLngs: function (t) { var e = Jn.prototype._convertLatLngs.call(this, t), n = e.length; return n >= 2 && e[0] instanceof O && e[0].equals(e[n - 1]) && e.pop(), e }, _setLatLngs: function (t) { Jn.prototype._setLatLngs.call(this, t), qt(this._latlngs) && (this._latlngs = [this._latlngs]) }, _defaultShape: function () { return qt(this._latlngs[0]) ? this._latlngs[0] : this._latlngs[0][0] }, _clipPoints: function () { var t = this._renderer._bounds, e = this.options.weight, n = new w(e, e); if (t = new P(t.min.subtract(n), t.max.add(n)), this._parts = [], this._pxBounds && this._pxBounds.intersects(t)) { if (this.options.noClip) return void (this._parts = this._rings); for (var i, r = 0, o = this._rings.length; r < o; r++)i = zt(this._rings[r], t, !0), i.length && this._parts.push(i) } }, _updatePath: function () { this._renderer._updatePoly(this, !0) }, _containsPoint: function (t) { var e, n, i, r, o, s, a, u, l = !1; if (!this._pxBounds || !this._pxBounds.contains(t)) return !1; for (r = 0, a = this._parts.length; r < a; r++)for (e = this._parts[r], o = 0, u = e.length, s = u - 1; o < u; s = o++)n = e[o], i = e[s], n.y > t.y != i.y > t.y && t.x < (i.x - n.x) * (t.y - n.y) / (i.y - n.y) + n.x && (l = !l); return l || Jn.prototype._containsPoint.call(this, t, !0) } }), Vn = Bn.extend({ initialize: function (t, e) { c(this, e), this._layers = {}, t && this.addData(t) }, addData: function (t) { var e, n, i, r = ee(t) ? t : t.features; if (r) { for (e = 0, n = r.length; e < n; e++)i = r[e], (i.geometries || i.geometry || i.features || i.coordinates) && this.addData(i); return this } var o = this.options; if (o.filter && !o.filter(t)) return this; var s = Ut(t, o); return s ? (s.feature = Yt(t), s.defaultOptions = s.options, this.resetStyle(s), o.onEachFeature && o.onEachFeature(t, s), this.addLayer(s)) : this }, resetStyle: function (t) { return t.options = e({}, t.defaultOptions), this._setLayerStyle(t, this.options.style), this }, setStyle: function (t) { return this.eachLayer(function (e) { this._setLayerStyle(e, t) }, this) }, _setLayerStyle: function (t, e) { "function" == typeof e && (e = e(t.feature)), t.setStyle && t.setStyle(e) } }), Yn = { toGeoJSON: function (t) { return Vt(this, { type: "Point", coordinates: Jt(this.getLatLng(), t) }) } }; zn.include(Yn), Hn.include(Yn), Wn.include(Yn), Jn.include({ toGeoJSON: function (t) { var e = !qt(this._latlngs), n = Zt(this._latlngs, e ? 1 : 0, !1, t); return Vt(this, { type: (e ? "Multi" : "") + "LineString", coordinates: n }) } }), Zn.include({ toGeoJSON: function (t) { var e = !qt(this._latlngs), n = e && !qt(this._latlngs[0]), i = Zt(this._latlngs, n ? 2 : e ? 1 : 0, !0, t); return e || (i = [i]), Vt(this, { type: (n ? "Multi" : "") + "Polygon", coordinates: i }) } }), Dn.include({ toMultiPoint: function (t) { var e = []; return this.eachLayer(function (n) { e.push(n.toGeoJSON(t).geometry.coordinates) }), Vt(this, { type: "MultiPoint", coordinates: e }) }, toGeoJSON: function (t) { var e = this.feature && this.feature.geometry && this.feature.geometry.type; if ("MultiPoint" === e) return this.toMultiPoint(t); var n = "GeometryCollection" === e, i = []; return this.eachLayer(function (e) { if (e.toGeoJSON) { var r = e.toGeoJSON(t); if (n) i.push(r.geometry); else { var o = Yt(r); "FeatureCollection" === o.type ? i.push.apply(i, o.features) : i.push(o) } } }), n ? Vt(this, { geometries: i, type: "GeometryCollection" }) : { type: "FeatureCollection", features: i } } }); var Xn = Xt; Object.freeze = Qt, t.version = "1.3.4", t.Browser = Ye, t.Evented = ae, t.Mixin = Ln, t.Util = oe, t.Class = v, t.Handler = wn, t.extend = e, t.bind = n, t.stamp = i, t.setOptions = c, t.DomEvent = vn, t.DomUtil = gn, t.PosAnimation = bn, t.Draggable = En, t.LineUtil = On, t.PolyUtil = Tn, t.Point = w, t.point = x, t.Bounds = P, t.bounds = S, t.Transformation = I, t.transformation = k, t.Projection = Cn, t.LatLng = O, t.latLng = T, t.LatLngBounds = M, t.latLngBounds = E, t.CRS = le, t.GeoJSON = Vn, t.geoJSON = Xt, t.geoJson = Xn, window.L || (window.L = t) }) }, function (e, n) { e.exports = t }, function (t, e, n) { "use strict"; var i, r, o, s = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }; !function (a, u) { "object" === s(e) && void 0 !== t ? u(e, n(0)) : (r = [e, n(0)], i = u, void 0 !== (o = "function" == typeof i ? i.apply(e, r) : i) && (t.exports = o)) }(0, function (t, e) { function n(t) { var e = ""; t.f = t.f || "json"; for (var n in t) if (t.hasOwnProperty(n)) { var i, r = t[n], o = Object.prototype.toString.call(r); e.length && (e += "&"), i = "[object Array]" === o ? "[object Object]" === Object.prototype.toString.call(r[0]) ? JSON.stringify(r) : r.join(",") : "[object Object]" === o ? JSON.stringify(r) : "[object Date]" === o ? r.valueOf() : r, e += encodeURIComponent(n) + "=" + encodeURIComponent(i) } return e } function i(t, n) { var i = new window.XMLHttpRequest; return i.onerror = function (r) { i.onreadystatechange = e.Util.falseFn, t.call(n, { error: { code: 500, message: "XMLHttpRequest error" } }, null) }, i.onreadystatechange = function () { var r, o; if (4 === i.readyState) { try { r = JSON.parse(i.responseText) } catch (t) { r = null, o = { code: 500, message: "Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error." } } !o && r.error && (o = r.error, r = null), i.onerror = e.Util.falseFn, t.call(n, o, r) } }, i.ontimeout = function () { this.onerror() }, i } function r(t, e, r, o) { var s = i(r, o); return s.open("POST", t), void 0 !== o && null !== o && void 0 !== o.options && (s.timeout = o.options.timeout), s.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8"), s.send(n(e)), s } function o(t, e, r, o) { var s = i(r, o); return s.open("GET", t + "?" + n(e), !0), void 0 !== o && null !== o && void 0 !== o.options && (s.timeout = o.options.timeout), s.send(null), s } function s(t, e, r, o) { var s = n(e), u = i(r, o), l = (t + "?" + s).length; if (l <= 2e3 && H.cors ? u.open("GET", t + "?" + s) : l > 2e3 && H.cors && (u.open("POST", t), u.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8")), void 0 !== o && null !== o && void 0 !== o.options && (u.timeout = o.options.timeout), l <= 2e3 && H.cors) u.send(null); else { if (!(l > 2e3 && H.cors)) return l <= 2e3 && !H.cors ? a(t, e, r, o) : void A("a request to " + t + " was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html"); u.send(s) } return u } function a(t, i, r, o) { window._EsriLeafletCallbacks = window._EsriLeafletCallbacks || {}; var s = "c" + Z; i.callback = "window._EsriLeafletCallbacks." + s, window._EsriLeafletCallbacks[s] = function (t) { if (!0 !== window._EsriLeafletCallbacks[s]) { var e, n = Object.prototype.toString.call(t); "[object Object]" !== n && "[object Array]" !== n && (e = { error: { code: 500, message: "Expected array or object as JSONP response" } }, t = null), !e && t.error && (e = t, t = null), r.call(o, e, t), window._EsriLeafletCallbacks[s] = !0 } }; var a = e.DomUtil.create("script", null, document.body); return a.type = "text/javascript", a.src = t + "?" + n(i), a.id = s, e.DomUtil.addClass(a, "esri-leaflet-jsonp"), Z++, { id: s, url: a.src, abort: function () { window._EsriLeafletCallbacks._callback[s]({ code: 0, message: "Request aborted." }) } } } function u(t, e) { for (var n = 0; n < t.length; n++)if (t[n] !== e[n]) return !1; return !0 } function l(t) { return u(t[0], t[t.length - 1]) || t.push(t[0]), t } function h(t) { var e, n = 0, i = 0, r = t.length, o = t[i]; for (i; i < r - 1; i++)e = t[i + 1], n += (e[0] - o[0]) * (e[1] + o[1]), o = e; return n >= 0 } function c(t, e, n, i) { var r = (i[0] - n[0]) * (t[1] - n[1]) - (i[1] - n[1]) * (t[0] - n[0]), o = (e[0] - t[0]) * (t[1] - n[1]) - (e[1] - t[1]) * (t[0] - n[0]), s = (i[1] - n[1]) * (e[0] - t[0]) - (i[0] - n[0]) * (e[1] - t[1]); if (0 !== s) { var a = r / s, u = o / s; if (a >= 0 && a <= 1 && u >= 0 && u <= 1) return !0 } return !1 } function f(t, e) { for (var n = 0; n < t.length - 1; n++)for (var i = 0; i < e.length - 1; i++)if (c(t[n], t[n + 1], e[i], e[i + 1])) return !0; return !1 } function d(t, e) { for (var n = !1, i = -1, r = t.length, o = r - 1; ++i < r; o = i)(t[i][1] <= e[1] && e[1] < t[o][1] || t[o][1] <= e[1] && e[1] < t[i][1]) && e[0] < (t[o][0] - t[i][0]) * (e[1] - t[i][1]) / (t[o][1] - t[i][1]) + t[i][0] && (n = !n); return n } function p(t, e) { var n = f(t, e), i = d(t, e[0]); return !(n || !i) } function g(t) { for (var e, n, i, r = [], o = [], s = 0; s < t.length; s++) { var a = l(t[s].slice(0)); if (!(a.length < 4)) if (h(a)) { var u = [a.slice().reverse()]; r.push(u) } else o.push(a.slice().reverse()) } for (var c = []; o.length;) { i = o.pop(); var d = !1; for (e = r.length - 1; e >= 0; e--)if (n = r[e][0], p(n, i)) { r[e].push(i), d = !0; break } d || c.push(i) } for (; c.length;) { i = c.pop(); var g = !1; for (e = r.length - 1; e >= 0; e--)if (n = r[e][0], f(n, i)) { r[e].push(i), g = !0; break } g || r.push([i.reverse()]) } return 1 === r.length ? { type: "Polygon", coordinates: r[0] } : { type: "MultiPolygon", coordinates: r } } function m(t) { var e = [], n = t.slice(0), i = l(n.shift().slice(0)); if (i.length >= 4) { h(i) || i.reverse(), e.push(i); for (var r = 0; r < n.length; r++) { var o = l(n[r].slice(0)); o.length >= 4 && (h(o) && o.reverse(), e.push(o)) } } return e } function _(t) { for (var e = [], n = 0; n < t.length; n++)for (var i = m(t[n]), r = i.length - 1; r >= 0; r--) { var o = i[r].slice(0); e.push(o) } return e } function y(t) { var e = {}; for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]); return e } function v(t, e) { for (var n = e ? [e, "OBJECTID", "FID"] : ["OBJECTID", "FID"], i = 0; i < n.length; i++) { var r = n[i]; if (r in t && ("string" == typeof t[r] || "number" == typeof t[r])) return t[r] } throw Error("No valid id attribute found") } function b(t, e) { var n = {}; if ("number" == typeof t.x && "number" == typeof t.y && (n.type = "Point", n.coordinates = [t.x, t.y], "number" == typeof t.z && n.coordinates.push(t.z)), t.points && (n.type = "MultiPoint", n.coordinates = t.points.slice(0)), t.paths && (1 === t.paths.length ? (n.type = "LineString", n.coordinates = t.paths[0].slice(0)) : (n.type = "MultiLineString", n.coordinates = t.paths.slice(0))), t.rings && (n = g(t.rings.slice(0))), (t.geometry || t.attributes) && (n.type = "Feature", n.geometry = t.geometry ? b(t.geometry) : null, n.properties = t.attributes ? y(t.attributes) : null, t.attributes)) try { n.id = v(t.attributes, e) } catch (t) { } return JSON.stringify(n.geometry) === JSON.stringify({}) && (n.geometry = null), t.spatialReference && t.spatialReference.wkid && 4326 !== t.spatialReference.wkid && console.warn("Object converted in non-standard crs - " + JSON.stringify(t.spatialReference)), n } function w(t, e) { e = e || "OBJECTID"; var n, i = { wkid: 4326 }, r = {}; switch (t.type) { case "Point": r.x = t.coordinates[0], r.y = t.coordinates[1], r.spatialReference = i; break; case "MultiPoint": r.points = t.coordinates.slice(0), r.spatialReference = i; break; case "LineString": r.paths = [t.coordinates.slice(0)], r.spatialReference = i; break; case "MultiLineString": r.paths = t.coordinates.slice(0), r.spatialReference = i; break; case "Polygon": r.rings = m(t.coordinates.slice(0)), r.spatialReference = i; break; case "MultiPolygon": r.rings = _(t.coordinates.slice(0)), r.spatialReference = i; break; case "Feature": t.geometry && (r.geometry = w(t.geometry, e)), r.attributes = t.properties ? y(t.properties) : {}, t.id && (r.attributes[e] = t.id); break; case "FeatureCollection": for (r = [], n = 0; n < t.features.length; n++)r.push(w(t.features[n], e)); break; case "GeometryCollection": for (r = [], n = 0; n < t.geometries.length; n++)r.push(w(t.geometries[n], e)) }return r } function x(t, e) { return w(t, e) } function L(t, e) { return b(t, e) } function P(t) { if ("NaN" !== t.xmin && "NaN" !== t.ymin && "NaN" !== t.xmax && "NaN" !== t.ymax) { var n = e.latLng(t.ymin, t.xmin), i = e.latLng(t.ymax, t.xmax); return e.latLngBounds(n, i) } return null } function S(t) { return t = e.latLngBounds(t), { xmin: t.getSouthWest().lng, ymin: t.getSouthWest().lat, xmax: t.getNorthEast().lng, ymax: t.getNorthEast().lat, spatialReference: { wkid: 4326 } } } function M(t) { var e; if (t.objectIdFieldName) e = t.objectIdFieldName; else if (t.fields) { for (var n = 0; n <= t.fields.length - 1; n++)if ("esriFieldTypeOID" === t.fields[n].type) { e = t.fields[n].name; break } if (!e) for (n = 0; n <= t.fields.length - 1; n++)if (t.fields[n].name.match(X)) { e = t.fields[n].name; break } } return e } function E(t) { for (var e in t.attributes) if (e.match(X)) return e } function O(t, e) { var n, i = t.features || t.results, r = i.length; n = e || M(t); var o = { type: "FeatureCollection", features: [] }; if (r) for (var s = i.length - 1; s >= 0; s--) { var a = L(i[s], n || E(i[s])); o.features.push(a) } return o } function T(t) { return t = e.Util.trim(t), "/" !== t[t.length - 1] && (t += "/"), t } function I(t) { if (-1 !== t.url.indexOf("?")) { t.requestParams = t.requestParams || {}; var e = t.url.substring(t.url.indexOf("?") + 1); t.url = t.url.split("?")[0], t.requestParams = JSON.parse('{"' + decodeURI(e).replace(/"/g, '\\"').replace(/&/g, '","').replace(/=/g, '":"') + '"}') } return t.url = T(t.url.split("?")[0]), t } function k(t) { return /^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(t) } function C(t) { var e; switch (t) { case "Point": e = "esriGeometryPoint"; break; case "MultiPoint": e = "esriGeometryMultipoint"; break; case "LineString": case "MultiLineString": e = "esriGeometryPolyline"; break; case "Polygon": case "MultiPolygon": e = "esriGeometryPolygon" }return e } function A() { console && console.warn && console.warn.apply(console, arguments) } function j(t) { return t.getSize().x - J.attributionWidthOffset + "px" } function R(t) { if (t.attributionControl && !t.attributionControl._esriAttributionAdded) { t.attributionControl.setPrefix('<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | Powered by <a href="https://www.esri.com">Esri</a>'); var n = document.createElement("style"); n.type = "text/css", n.innerHTML = ".esri-truncated-attribution:hover {white-space: normal;}", document.getElementsByTagName("head")[0].appendChild(n), e.DomUtil.addClass(t.attributionControl._container, "esri-truncated-attribution:hover"); var i = document.createElement("style"); i.type = "text/css", i.innerHTML = ".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: " + j(t) + ";}", document.getElementsByTagName("head")[0].appendChild(i), e.DomUtil.addClass(t.attributionControl._container, "esri-truncated-attribution"), t.on("resize", function (e) { t.attributionControl._container.style.maxWidth = j(e.target) }), t.on("unload", function () { n.parentNode.removeChild(n), i.parentNode.removeChild(i); for (var t = document.querySelectorAll(".esri-leaflet-jsonp"), e = 0; e < t.length; e++)t.item(e).parentNode.removeChild(t.item(e)) }), t.attributionControl._esriAttributionAdded = !0 } } function N(t) { var n = { geometry: null, geometryType: null }; return t instanceof e.LatLngBounds ? (n.geometry = S(t), n.geometryType = "esriGeometryEnvelope", n) : (t.getLatLng && (t = t.getLatLng()), t instanceof e.LatLng && (t = { type: "Point", coordinates: [t.lng, t.lat] }), t instanceof e.GeoJSON && (t = t.getLayers()[0].feature.geometry, n.geometry = x(t), n.geometryType = C(t.type)), t.toGeoJSON && (t = t.toGeoJSON()), "Feature" === t.type && (t = t.geometry), "Point" === t.type || "LineString" === t.type || "Polygon" === t.type || "MultiPolygon" === t.type ? (n.geometry = x(t), n.geometryType = C(t.type), n) : void A("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object")) } function D(t, n) { a(t, {}, e.Util.bind(function (t, i) { if (!t) { n._esriAttributions = []; for (var r = 0; r < i.contributors.length; r++)for (var o = i.contributors[r], s = 0; s < o.coverageAreas.length; s++) { var a = o.coverageAreas[s], u = e.latLng(a.bbox[0], a.bbox[1]), l = e.latLng(a.bbox[2], a.bbox[3]); n._esriAttributions.push({ attribution: o.attribution, score: a.score, bounds: e.latLngBounds(u, l), minZoom: a.zoomMin, maxZoom: a.zoomMax }) } n._esriAttributions.sort(function (t, e) { return e.score - t.score }); B({ target: n }) } }, this)) } function B(t) { var n = t.target, i = n._esriAttributions; if (n && n.attributionControl && i) { for (var r = "", o = n.getBounds(), s = e.latLngBounds(o.getSouthWest().wrap(), o.getNorthEast().wrap()), a = n.getZoom(), u = 0; u < i.length; u++) { var l = i[u], h = l.attribution; !r.match(h) && l.bounds.intersects(s) && a >= l.minZoom && a <= l.maxZoom && (r += ", " + h) } r = r.substr(2); var c = n.attributionControl._container.querySelector(".esri-dynamic-attribution"); c.innerHTML = r, c.style.maxWidth = j(n), n.fire("attributionupdated", { attribution: r }) } } function F(t) { return t = I(t), new $(t) } function q(t) { return new K(t) } function G(t) { return new tt(t) } function z(t) { return new et(t) } var U = window.XMLHttpRequest && "withCredentials" in new window.XMLHttpRequest, W = "" === document.documentElement.style.pointerEvents, H = { cors: U, pointerEvents: W }, J = { attributionWidthOffset: 55 }, Z = 0, V = H.cors ? o : a; V.CORS = o, V.JSONP = a; var Y = { request: s, get: V, post: r }, X = /^(OBJECTID|FID|OID|ID)$/i, Q = { warn: A, cleanUrl: T, getUrlParams: I, isArcgisOnline: k, geojsonTypeToArcGIS: C, responseToFeatureCollection: O, geojsonToArcGIS: x, arcgisToGeoJSON: L, boundsToExtent: S, extentToBounds: P, calcAttributionWidth: j, setEsriAttribution: R, _setGeometry: N, _getAttributionData: D, _updateMapAttribution: B, _findIdAttributeFromFeature: E, _findIdAttributeFromResponse: M }, $ = e.Class.extend({ options: { proxy: !1, useCors: U }, generateSetter: function (t, n) { return e.Util.bind(function (e) { return this.params[t] = e, this }, n) }, initialize: function (t) { if (t.request && t.options ? (this._service = t, e.Util.setOptions(this, t.options)) : (e.Util.setOptions(this, t), this.options.url = T(t.url)), this.params = e.Util.extend({}, this.params || {}), this.setters) for (var n in this.setters) { var i = this.setters[n]; this[n] = this.generateSetter(i, this) } }, token: function (t) { return this._service ? this._service.authenticate(t) : this.params.token = t, this }, format: function (t) { return this.params.returnUnformattedValues = !t, this }, request: function (t, n) { return this.options.requestParams && e.Util.extend(this.params, this.options.requestParams), this._service ? this._service.request(this.path, this.params, t, n) : this._request("request", this.path, this.params, t, n) }, _request: function (t, e, n, i, r) { var o = this.options.proxy ? this.options.proxy + "?" + this.options.url + e : this.options.url + e; return "get" !== t && "request" !== t || this.options.useCors ? Y[t](o, n, i, r) : Y.get.JSONP(o, n, i, r) } }), K = $.extend({ setters: { offset: "resultOffset", limit: "resultRecordCount", fields: "outFields", precision: "geometryPrecision", featureIds: "objectIds", returnGeometry: "returnGeometry", returnM: "returnM", transform: "datumTransformation", token: "token" }, path: "query", params: { returnGeometry: !0, where: "1=1", outSr: 4326, outFields: "*" }, within: function (t) { return this._setGeometryParams(t), this.params.spatialRel = "esriSpatialRelContains", this }, intersects: function (t) { return this._setGeometryParams(t), this.params.spatialRel = "esriSpatialRelIntersects", this }, contains: function (t) { return this._setGeometryParams(t), this.params.spatialRel = "esriSpatialRelWithin", this }, crosses: function (t) { return this._setGeometryParams(t), this.params.spatialRel = "esriSpatialRelCrosses", this }, touches: function (t) { return this._setGeometryParams(t), this.params.spatialRel = "esriSpatialRelTouches", this }, overlaps: function (t) { return this._setGeometryParams(t), this.params.spatialRel = "esriSpatialRelOverlaps", this }, bboxIntersects: function (t) { return this._setGeometryParams(t), this.params.spatialRel = "esriSpatialRelEnvelopeIntersects", this }, indexIntersects: function (t) { return this._setGeometryParams(t), this.params.spatialRel = "esriSpatialRelIndexIntersects", this }, nearby: function (t, n) { return t = e.latLng(t), this.params.geometry = [t.lng, t.lat], this.params.geometryType = "esriGeometryPoint", this.params.spatialRel = "esriSpatialRelIntersects", this.params.units = "esriSRUnit_Meter", this.params.distance = n, this.params.inSr = 4326, this }, where: function (t) { return this.params.where = t, this }, between: function (t, e) { return this.params.time = [t.valueOf(), e.valueOf()], this }, simplify: function (t, e) { var n = Math.abs(t.getBounds().getWest() - t.getBounds().getEast()); return this.params.maxAllowableOffset = n / t.getSize().y * e, this }, orderBy: function (t, e) { return e = e || "ASC", this.params.orderByFields = this.params.orderByFields ? this.params.orderByFields + "," : "", this.params.orderByFields += [t, e].join(" "), this }, run: function (t, e) { return this._cleanParams(), this.options.isModern || k(this.options.url) ? (this.params.f = "geojson", this.request(function (n, i) { this._trapSQLerrors(n), t.call(e, n, i, i) }, this)) : this.request(function (n, i) { this._trapSQLerrors(n), t.call(e, n, i && O(i), i) }, this) }, count: function (t, e) { return this._cleanParams(), this.params.returnCountOnly = !0, this.request(function (e, n) { t.call(this, e, n && n.count, n) }, e) }, ids: function (t, e) { return this._cleanParams(), this.params.returnIdsOnly = !0, this.request(function (e, n) { t.call(this, e, n && n.objectIds, n) }, e) }, bounds: function (t, e) { return this._cleanParams(), this.params.returnExtentOnly = !0, this.request(function (n, i) { i && i.extent && P(i.extent) ? t.call(e, n, P(i.extent), i) : (n = { message: "Invalid Bounds" }, t.call(e, n, null, i)) }, e) }, distinct: function () { return this.params.returnGeometry = !1, this.params.returnDistinctValues = !0, this }, pixelSize: function (t) { var n = e.point(t); return this.params.pixelSize = [n.x, n.y], this }, layer: function (t) { return this.path = t + "/query", this }, _trapSQLerrors: function (t) { t && "400" === t.code && A("one common syntax error in query requests is encasing string values in double quotes instead of single quotes") }, _cleanParams: function () { delete this.params.returnIdsOnly, delete this.params.returnExtentOnly, delete this.params.returnCountOnly }, _setGeometryParams: function (t) { this.params.inSr = 4326; var e = N(t); this.params.geometry = e.geometry, this.params.geometryType = e.geometryType } }), tt = $.extend({ setters: { contains: "contains", text: "searchText", fields: "searchFields", spatialReference: "sr", sr: "sr", layers: "layers", returnGeometry: "returnGeometry", maxAllowableOffset: "maxAllowableOffset", precision: "geometryPrecision", dynamicLayers: "dynamicLayers", returnZ: "returnZ", returnM: "returnM", gdbVersion: "gdbVersion", token: "token" }, path: "find", params: { sr: 4326, contains: !0, returnGeometry: !0, returnZ: !0, returnM: !1 }, layerDefs: function (t, e) { return this.params.layerDefs = this.params.layerDefs ? this.params.layerDefs + ";" : "", this.params.layerDefs += [t, e].join(":"), this }, simplify: function (t, e) { var n = Math.abs(t.getBounds().getWest() - t.getBounds().getEast()); return this.params.maxAllowableOffset = n / t.getSize().y * e, this }, run: function (t, e) { return this.request(function (n, i) { t.call(e, n, i && O(i), i) }, e) } }), et = $.extend({ path: "identify", between: function (t, e) { return this.params.time = [t.valueOf(), e.valueOf()], this } }); t.VERSION = "2.1.4", t.Support = H, t.options = J, t.Util = Q, t.get = V, t.post = r, t.request = s, t.Task = $, t.task = F, t.Query = K, t.query = q, t.Find = tt, t.find = G, t.Identify = et, t.identify = z }) }, function (t, e, n) { "use strict"; function i(t) { return t && t.__esModule ? t : { default: t } } var r = n(1), o = (i(r), n(0)), s = i(o), a = n(2), u = i(a), l = n(4), h = n(5); window.gsp3d || console.log("请首先引入 cesium-mars 基础库，才能使用该插件！ http://www.dehui.info"), gsp3d.L = s.default, gsp3d.L.esri = u.default, gsp3d.layer.ArcFeatureLayer = l.ArcFeatureLayer, gsp3d.layer.regLayerForConfig("arcgis_feature2", l.ArcFeatureLayer), gsp3d.layer.ArcFeatureGridLayer = h.ArcFeatureGridLayer, gsp3d.layer.regLayerForConfig("arcgis_feature", h.ArcFeatureGridLayer) }, function (t, e, n) { "use strict"; function i(t) { return t && t.__esModule ? t : { default: t } } Object.defineProperty(e, "__esModule", { value: !0 }), e.ArcFeatureLayer = void 0; var r = n(1), o = i(r), s = n(0), a = (i(s), n(2)), u = i(a), l = gsp3d.layer.GeoJsonLayer.extend({ queryData: function () { this.dataSource && (this.viewer.dataSources.remove(this.dataSource), this.dataSource = null); var t = this, e = this.config.url; this.config.layers && this.config.layers.length > 0 && (e += "/" + this.config.layers[0]); var n = u.default.query({ url: e }); this.config.where && n.where(this.config.where), n.run(function (e, n, i) { if (null != e && e.code > 0) return void gsp3d.util.alert(e.message, "服务访问出错"); if (void 0 == n || null == n || 0 == n.features.length) return void gsp3d.util.msg("未找到符合查询条件的要素！"); for (var r = [], s = 0; s < n.features.length; s++) { var a = n.features[s]; null != a && null != a.geometry && (a.geometry.coordinates && 0 == a.geometry.coordinates.length || r.push(a)) } n.features = r, o.default.GeoJsonDataSource.load(n, { clampToGround: !0 }).then(function (e) { t.showResult(e) }).otherwise(function (e) { t.showError("服务出错", e) }) }) }, setWhere: function (t) { this.config.where = t, this.queryData() } }); e.ArcFeatureLayer = l }, function (t, e, n) { "use strict"; function i(t) { return t && t.__esModule ? t : { default: t } } Object.defineProperty(e, "__esModule", { value: !0 }), e.ArcFeatureGridLayer = void 0; var r = n(1), o = i(r), s = n(0), a = i(s), u = n(2), l = i(u), h = gsp3d.layer.CustomFeatureGridLayer.extend({ getDataForGrid: function (t, e) { var n = this, i = this.config.url; this.config.layers && this.config.layers.length > 0 && (i += "/" + this.config.layers[0]); var r = l.default.query({ url: i }), o = a.default.latLngBounds(a.default.latLng(t.rectangle.ymin, t.rectangle.xmin), a.default.latLng(t.rectangle.ymax, t.rectangle.xmax)); r.within(o), this.config.where && r.where(this.config.where), r.run(function (i, r, o) { if (n._visible && n._cacheGrid[t.key]) return null != i && i.code > 0 ? void console.log("arcgis服务访问出错" + i.message) : void (void 0 != r && null != r && ("Feature" == r.type && (r = { type: "FeatureCollection", features: [r] }), e(r.features))) }) }, createEntity: function (t, e, n) { var i = this; return o.default.GeoJsonDataSource.load(e, { clampToGround: !0 }).then(function (e) { if (!i.checkHasBreak[t.key]) { if (0 == e.entities.values.length) return null; var r = e.entities.values[0]; r._id = i.config.id + "_" + t.key + "_" + r.id, i._addEntity(r, n) } }).otherwise(function (t) { i.showError("服务出错", t) }), null }, _addEntity: function (t, e) { var n = this, i = this.config.symbol; i && ("function" == typeof i ? i(t, t.properties) : "default" == i ? this.setDefSymbol(t) : this.setConfigSymbol(t, i)), (this.config.columns || this.config.popup) && (t.popup = { html: function (t) { return n.viewer.gsp.popup.getPopupForConfig(n.config, t.properties) }, anchor: this.config.popupAnchor || [0, -15] }), this.config.tooltip && (t.tooltip = { html: function (t) { return n.viewer.gsp.popup.getPopupForConfig({ popup: n.config.tooltip }, t.properties) }, anchor: this.config.tooltipAnchor || [0, -15] }), this.dataSource.entities.add(t), e(t) }, setWhere: function (t) { this.config.where = t, this.reload() } }); e.ArcFeatureGridLayer = h }]) });